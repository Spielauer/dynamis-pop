//LABEL(ImmigrationBackMigration, EN) Back Migration

/* NOTE(ImmigrationBackMigration, EN)
This module implements back migration
*/

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Parameters
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

parameters
{
    logical ModelBackmigration;
    double BackMigrationHazard;
};

parameter_group PG04_BackMigration                              //EN Back migration
{
    ModelBackmigration,
    BackMigrationHazard
};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Actor states and functions
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

actor Person
{
    event   timeBackMigrationEvent, BackMigrationEvent;       //EN Back Migration Event
};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Implementation
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

TIME Person::timeBackMigrationEvent()
{
    if (!is_resident && ModelBackmigration && ever_resident && calendar_year >= MIN(SIM_YEAR_RANGE) && BackMigrationHazard > 0)
    {
        return WAIT(-TIME(log(RandUniform(16)) / BackMigrationHazard));
    }
    else return TIME_INFINITE;
};

void Person::BackMigrationEvent()
{
    doResidentialMove(geo_prev);
}